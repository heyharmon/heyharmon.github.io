<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
<style>
*{margin:0px;padding:0px}#chatbox{font-family:"Open Sans", sans-serif;font-weight:400;width:330px;background:#fff;-webkit-box-shadow:0 0 12px rgba(0,0,0,0.2);-moz-box-shadow:0 0 12px rgba(0,0,0,0.2);box-shadow:0 0 12px rgba(0,0,0,0.2);border-radius:6px 6px 0 0;overflow:hidden;height:484px;position:fixed;bottom:0;right:20px;margin-left:-155px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;z-index:999999}.floatingImg{width:40px;border-radius:50%;position:absolute;top:0;left:12px;border:3px solid #fff}#chatview{width:330px;height:484px;position:absolute;top:0;left:0;background:#fff}#profile{background:#fff url("https://firebasestorage.googleapis.com/v0/b/bloomchat-5987d.appspot.com/o/clients%2Fbloomcu%2Fmedia%2Fbot-cover-img-blue.jpg?alt=media&token=9fdd1e21-1092-469a-8160-65bfb0efb5c7") no-repeat center center;background-size:cover;height:153px;overflow:hidden;text-align:center;color:#fff}#profile img{width:68px;height:68px;border:3px solid #fff;margin:23px 0 0;border-radius:50%}#profile p{font-weight:600;font-size:15px;opacity:1;padding:8px 0 0 0;line-height:0px}#profile span{font-weight:600;font-size:14px;line-height:0}#profile span:before{background:#5fff72;border-radius:5px;content:'';display:inline-block;position:relative;width:8px;height:8px;line-height:8px;margin:0 3px -1px 0;vertical-align:0.07em}#chat-messages{opacity:1;width:330px;height:calc(100% - 60px);overflow-y:auto;overflow-x:hidden;-webkit-transition:all 200ms cubic-bezier(0.000, 0.995, 0.990, 1.000);-moz-transition:all 200ms cubic-bezier(0.000, 0.995, 0.990, 1.000);-ms-transition:all 200ms cubic-bezier(0.000, 0.995, 0.990, 1.000);-o-transition:all 200ms cubic-bezier(0.000, 0.995, 0.990, 1.000);transition:all 200ms cubic-bezier(0.000, 0.995, 0.990, 1.000)}#chat-messages.animate{opacity:1;margin-top:0}#chat-messages ::-webkit-scrollbar{transition:all .5s;width:5px;height:1px;z-index:10}#chat-messages ::-webkit-scrollbar-track{background:transparent}#chat-messages ::-webkit-scrollbar-thumb{background:#b3ada7}#chat-messages label{color:#aab8c2;font-weight:600;font-size:12px;text-align:center;margin:15px 0;width:330px;display:block}#chat-messages div.message{padding:15px 0 15px 48px;clear:both;margin-right:17px}#chat-messages div.message.right{padding:15px 36px 15px 0;margin-right:-19px;margin-left:19px}#chat-messages .message img{float:left;margin-left:-38px;border-radius:50%;width:30px;height:30px;margin-top:12px;background-color:#f0f4f7}#chat-messages div.message.right img{float:right;margin-left:0;margin-right:-38px}.message .bubble{background:#f0f4f7;font-size:16px;font-weight:400;line-height:22px;padding:12px 13px;border-radius:0 20px 20px 20px;color:#000;position:relative;float:left}.message:last-child .bubble{margin:0 0 15px 0}#chat-messages div.message.right .bubble{float:right;border-radius:20px 0 20px 20px;background:#d4f2fc}.bubble span{color:#aab8c2;font-size:11px;position:absolute;right:0;bottom:-22px}#sendmessage{height:60px;border-top:1px solid #e7ebee;position:absolute;bottom:0;right:0px;width:330px;background:#fff}#sendmessage input{background:#fff;border:none;color:#000;padding:19px 0 0 16px !important;font-size:15px;width:252px;-webkit-box-shadow:none !important;-moz-box-shadow:none !important;box-shadow:none !important}#sendmessage input:focus{outline:0}#sendmessage button{background:#fff url("https://s3-us-west-2.amazonaws.com/s.cdpn.io/245657/send.png") 0 -41px no-repeat;width:30px;height:30px;position:absolute;right:15px;top:23px;border:none}#sendmessage button:hover{cursor:pointer;background-position:0 0}#sendmessage button:focus{outline:0}
</style>
    <div id="chatbox">
        <div id="chatview">
            <div id="chat-messages">
              <div id="profile">
                  <img src="https://firebasestorage.googleapis.com/v0/b/bloomchat-5987d.appspot.com/o/clients%2Fbloomcu%2Fmedia%2Fbot-avatar.jpg?alt=media&token=db67be0f-423c-431c-b91d-3288083bfc35" />
                  <p>Chip</p>
                  <span>Online</span>
              </div>
              <!-- Starting bot chat -->
            	<div class="message">
        				<img src="https://firebasestorage.googleapis.com/v0/b/bloomchat-5987d.appspot.com/o/clients%2Fbloomcu%2Fmedia%2Fbot-avatar.jpg?alt=media&token=db67be0f-423c-431c-b91d-3288083bfc35" />
        				<div class="bubble">
        					Hi! I'm Chip. Do you want to buy a new car, a used car, or re-finance?
    				    </div>
              </div>
            </div><!-- /#chat-messages -->
            <div id="sendmessage">
            	<input id="user-input" type="text" onkeydown="if (event.keyCode == 13) { doTalk(); }" placeholder="Send message..." autocomplete="off" />
                <button id="send" onclick="doTalk()"></button>
            </div>
        </div><!-- /#chatview -->
    </div><!-- /#chatbox -->
<script type="text/javascript">
function Pandorabot(host, app_id, botname, user_key) {
    this.host = host;
    this.app_id = "1409612761147";
    this.botname = "chip";
    this.user_key = "df02842140df124c272ce6909134f7de";
    this.sessionid = "";
    this.protocol = "https";
}
Pandorabot.prototype.talk = function(input, fn) {
    var pb = this;
    var cookie = document.cookie.replace(/(?:(?:^|.*;\s*)pb_client_name\s*\=\s*([^;]*).*$)|^.*$/, "$1");
    if (cookie) {
        pb.client_name = cookie;
    } else {
        var c = Math.round(Math.random() * 1000001);
        document.cookie = "pb_client_name=" + c;
        pb.client_name = c;
    }
    var url = this.protocol + "://" + this.host + "/talk/" + this.app_id + "/" + this.botname + "?user_key=" + this.user_key + "&client_name=" + this.client_name + "&sessionid=" + this.sessionid + "&input=" + encodeURIComponent(input) + "&extra=true";
    var xhr = new XMLHttpRequest();
    xhr.open("POST", url, true);
    xhr.send();
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
            var p = JSON.parse(xhr.responseText);
            pb.sessionid = p["sessionid"];
            fn(p);
        }
    };
};
</script>
<script type="text/javascript">
// You can get your username and user key from your Developer Portal
// You must have already created and compiled a bot before you can talk to it
var pb = new Pandorabot("aiaas.pandorabots.com", "1409612761147", "chip", "df02842140df124c272ce6909134f7de");
var outputArea = document.getElementById("chat-messages");
function doTalk() {
  var userInput = document.getElementById("user-input").value;
  document.getElementById("user-input").value = "";
  outputArea.innerHTML = outputArea.innerHTML + (`
  	<div class="message right">
  		<div class="bubble">
  			${userInput}
  		</div>
  	</div>
  `);
  // Scroll to bottom after user chat
  var afterUserChat = document.getElementById("chat-messages");
  afterUserChat.scrollTop = afterUserChat.scrollHeight;
  pb.talk(userInput, function(data) {
    var response = data["responses"];
    console.log(response);
    setTimeout(function() {
      outputArea.innerHTML = outputArea.innerHTML + (`
      	<div class="message">
  				<img src="https://firebasestorage.googleapis.com/v0/b/bloomchat-5987d.appspot.com/o/clients%2Fbloomcu%2Fmedia%2Fbot-avatar.jpg?alt=media&token=db67be0f-423c-431c-b91d-3288083bfc35" />
  				<div class="bubble">
  					${response}
  		    </div>
        </div>
      `);
      // Scroll to bottom after bot chat
      var afterBotChat = document.getElementById("chat-messages");
      afterBotChat.scrollTop = afterBotChat.scrollHeight;
    }, 400);
  });
}
</script>
